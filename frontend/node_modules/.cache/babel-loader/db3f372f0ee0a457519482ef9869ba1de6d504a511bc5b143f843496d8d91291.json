{"ast":null,"code":"import { csrfFetch } from \"./csrf\";\nconst LOAD = 'bookings/LOAD';\nconst CREATE = 'bookings/CREATE';\nconst UPDATE = 'bookings/UPDATE';\nconst GET_ONE = 'bookings/GET_ONE';\nconst DELETE = 'bookings/DELETE';\nconst load = bookings => ({\n  type: LOAD,\n  bookings\n});\nconst create = booking => ({\n  type: CREATE,\n  booking\n});\nconst remove = bookingId => ({\n  type: DELETE,\n  bookingId\n});\nexport const allBookingsByUser = () => async dispatch => {\n  console.log(\"hello from booking thunk\");\n  const response = await fetch(`/api/bookings/current`);\n  console.log(\"response in booking thunk\", response);\n  if (response.ok) {\n    const {\n      Bookings\n    } = await response.json();\n    dispatch(load(Bookings));\n    return Bookings;\n  }\n};\nexport const allBookingsBySpot = spotId => async dispatch => {\n  const response = await fetch(`/api/spots/${spotId}/bookings`);\n  if (response.ok) {\n    const {\n      Bookings\n    } = await response.json();\n    dispatch(load(Bookings));\n    return Bookings;\n  }\n};\nexport const createBooking = (spotId, payload) => async dispatch => {\n  const response = await csrfFetch(`/api/spots/${spotId}/bookings`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(payload)\n  });\n  if (response.ok) {\n    const booking = await response.json();\n    console.log(\"Booking in thunk\", booking);\n    dispatch(create(booking));\n    return booking;\n  }\n  return response;\n};\nexport const editBooking = (payload, bookingId) => async dispatch => {\n  const response = await csrf;\n};\nexport const deleteBooking = bookingId => async dispatch => {\n  const response = await csrfFetch(`/api/bookings/${bookingId}`, {\n    method: 'DELETE',\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  });\n  if (response.ok) {\n    const {\n      message\n    } = await response.json();\n    dispatch(remove(bookingId));\n    return message;\n  }\n  return response;\n};\nconst intialState = {\n  allBookings: {},\n  singleBooking: {}\n};\nconst bookingReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : intialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  let newState;\n  switch (action.type) {\n    case LOAD:\n      {\n        newState = {\n          ...state,\n          allBookings: {\n            ...state.allBookings\n          },\n          singleBooking: {\n            ...state.singleBooking\n          }\n        };\n        let bookingPlaceholder = {};\n        action.bookings.forEach(booking => {\n          bookingPlaceholder[booking.id] = booking;\n        });\n        newState.allBookings = bookingPlaceholder;\n        return newState;\n      }\n    case CREATE:\n      {\n        newState = {\n          ...state,\n          allBookings: {\n            ...state.allBookings\n          }\n        };\n        newState.allBookings[action.booking.id] = action.booking;\n        return newState;\n      }\n    case DELETE:\n      {\n        newState = {\n          ...state,\n          allBookings: {\n            ...state.allBookings\n          }\n        };\n        delete newState[action.bookingId];\n        return newState;\n      }\n    default:\n      return state;\n  }\n};\nexport default bookingReducer;","map":{"version":3,"names":["csrfFetch","LOAD","CREATE","UPDATE","GET_ONE","DELETE","load","bookings","type","create","booking","remove","bookingId","allBookingsByUser","dispatch","console","log","response","fetch","ok","Bookings","json","allBookingsBySpot","spotId","createBooking","payload","method","headers","body","JSON","stringify","editBooking","csrf","deleteBooking","message","intialState","allBookings","singleBooking","bookingReducer","state","action","newState","bookingPlaceholder","forEach","id"],"sources":["/home/marc/exercise/projects/airbnb/frontend/src/store/bookingReducer.js"],"sourcesContent":["import { csrfFetch } from \"./csrf\"\nconst LOAD = 'bookings/LOAD'\nconst CREATE = 'bookings/CREATE'\nconst UPDATE = 'bookings/UPDATE'\nconst GET_ONE = 'bookings/GET_ONE'\nconst DELETE = 'bookings/DELETE'\n\nconst load = bookings => ({\n    type: LOAD,\n    bookings\n})\n\nconst create = booking => ({\n    type: CREATE,\n    booking\n})\n\nconst remove = bookingId => ({\n    type: DELETE,\n    bookingId\n})\n\n\nexport const allBookingsByUser = () => async dispatch => {\n    console.log(\"hello from booking thunk\")\n    const response = await fetch (`/api/bookings/current`);\n    console.log(\"response in booking thunk\",response)\n    if(response.ok){\n        const {Bookings} = await response.json()\n        dispatch(load(Bookings))\n        return Bookings\n    }\n}\n\nexport const allBookingsBySpot = (spotId) =>async dispatch => {\n    const response = await fetch (`/api/spots/${spotId}/bookings`)\n\n    if(response.ok){\n        const {Bookings} = await response.json()\n        dispatch(load(Bookings))\n        return Bookings\n    }\n}\n\nexport const createBooking = (spotId, payload) => async dispatch => {\n    const response = await csrfFetch (`/api/spots/${spotId}/bookings`, {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify(payload)\n    })\n\n    if(response.ok){\n        const booking = await response.json()\n        console.log(\"Booking in thunk\", booking)\n        dispatch(create(booking))\n        return booking\n    }\n    return response\n}\n\nexport const editBooking = (payload, bookingId)=> async dispatch => {\n    const response = await csrf\n}\n\nexport const deleteBooking = (bookingId) => async dispatch => {\n    const response = await csrfFetch(`/api/bookings/${bookingId}`, {\n        method: 'DELETE',\n        headers: {'Content-Type': 'application/json'}\n    })\n    if(response.ok){\n        const{message} = await response.json()\n        dispatch(remove(bookingId))\n        return message\n    }\n    return response\n}\n\n\n\n\nconst intialState = {allBookings:{}, singleBooking: {}}\n\nconst bookingReducer = (state = intialState, action) => {\n    let newState;\n    switch (action.type) {\n        case LOAD: {\n            newState = {...state, allBookings: {...state.allBookings}, singleBooking: {...state.singleBooking}}\n            let bookingPlaceholder = {}\n            action.bookings.forEach(booking => {\n                bookingPlaceholder[booking.id] = booking\n            })\n            newState.allBookings = bookingPlaceholder\n            return newState\n        }\n        case CREATE:{\n            newState = {...state, allBookings: {...state.allBookings}}\n            newState.allBookings[action.booking.id] = action.booking\n            return newState\n        }\n        case DELETE:{\n            newState = {...state, allBookings: {...state.allBookings}}\n            delete newState[action.bookingId]\n            return newState\n        }\n        default:\n            return state\n    }\n}\n\nexport default bookingReducer\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}