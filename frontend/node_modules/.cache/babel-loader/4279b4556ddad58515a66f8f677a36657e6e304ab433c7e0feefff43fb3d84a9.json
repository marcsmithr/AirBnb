{"ast":null,"code":"import { csrfFetch } from \"./csrf\";\nconst LOAD = 'bookings/LOAD';\nconst CREATE = 'bookings/CREATE';\nconst UPDATE = 'bookings/UPDATE';\nconst GET_ONE = 'bookings/GET_ONE';\nconst DELETE = 'bookings/DELETE';\nconst load = bookings => ({\n  type: LOAD,\n  bookings\n});\nconst create = booking => ({\n  type: CREATE,\n  booking\n});\nexport const allBookingsByUser = () => async dispatch => {\n  console.log(\"hello from booking thunk\");\n  const response = await fetch(`/api/bookings/current`);\n  console.log(\"response in booking thunk\", response);\n  if (response.ok) {\n    const {\n      Bookings\n    } = await response.json();\n    dispatch(load(Bookings));\n    return Bookings;\n  }\n};\nexport const allBookingsBySpot = spotId => async dispatch => {\n  const response = await fetch(`/api/spots/${spotId}/bookings`);\n  if (response.ok) {\n    const {\n      Bookings\n    } = await response.json();\n    dispatch(load(Bookings));\n    return Bookings;\n  }\n};\nexport const createBooking = (spotId, payload) => async dispatch => {\n  const response = await csrfFetch(`/api/spots/${spotId}/bookings`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(payload)\n  });\n  if (response.ok) {\n    const {\n      booking\n    } = await response.json();\n    console.log(\"Booking in thunk\", booking);\n    dispatch(create(booking));\n  }\n};\nexport const deleteBooking = bookingId => async dispatch => {\n  const response = await csrfFetch(`/api/bookings/`);\n};\nconst intialState = {\n  allBookings: {},\n  singleBooking: {}\n};\nconst bookingReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : intialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  let newState;\n  switch (action.type) {\n    case LOAD:\n      {\n        newState = {\n          ...state,\n          allBookings: {\n            ...state.allBookings\n          },\n          singleBooking: {\n            ...state.singleBooking\n          }\n        };\n        let bookingPlaceholder = {};\n        action.bookings.forEach(booking => {\n          bookingPlaceholder[booking.id] = booking;\n        });\n        newState.allBookings = bookingPlaceholder;\n        return newState;\n      }\n    case CREATE:\n      {\n        newState = {\n          ...state,\n          allBookings: {\n            ...state.allBookings\n          }\n        };\n        newState.allBookings[action.booking.id] = action.booking;\n        return newState;\n      }\n    default:\n      return state;\n  }\n};\nexport default bookingReducer;","map":{"version":3,"names":["csrfFetch","LOAD","CREATE","UPDATE","GET_ONE","DELETE","load","bookings","type","create","booking","allBookingsByUser","dispatch","console","log","response","fetch","ok","Bookings","json","allBookingsBySpot","spotId","createBooking","payload","method","headers","body","JSON","stringify","deleteBooking","bookingId","intialState","allBookings","singleBooking","bookingReducer","state","action","newState","bookingPlaceholder","forEach","id"],"sources":["/home/marc/exercise/projects/airbnb/frontend/src/store/bookingReducer.js"],"sourcesContent":["import { csrfFetch } from \"./csrf\"\nconst LOAD = 'bookings/LOAD'\nconst CREATE = 'bookings/CREATE'\nconst UPDATE = 'bookings/UPDATE'\nconst GET_ONE = 'bookings/GET_ONE'\nconst DELETE = 'bookings/DELETE'\n\nconst load = bookings => ({\n    type: LOAD,\n    bookings\n})\n\nconst create = booking => ({\n    type: CREATE,\n    booking\n})\n\n\nexport const allBookingsByUser = () => async dispatch => {\n    console.log(\"hello from booking thunk\")\n    const response = await fetch (`/api/bookings/current`);\n    console.log(\"response in booking thunk\",response)\n    if(response.ok){\n        const {Bookings} = await response.json()\n        dispatch(load(Bookings))\n        return Bookings\n    }\n}\n\nexport const allBookingsBySpot = (spotId) =>async dispatch => {\n    const response = await fetch (`/api/spots/${spotId}/bookings`)\n\n    if(response.ok){\n        const {Bookings} = await response.json()\n        dispatch(load(Bookings))\n        return Bookings\n    }\n}\n\nexport const createBooking = (spotId, payload) => async dispatch => {\n    const response = await csrfFetch (`/api/spots/${spotId}/bookings`, {\n        method: 'POST',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify(payload)\n    })\n\n    if(response.ok){\n        const {booking} = await response.json()\n        console.log(\"Booking in thunk\", booking)\n        dispatch(create(booking))\n    }\n}\n\nexport const deleteBooking = (bookingId) => async dispatch => {\n    const response = await csrfFetch(`/api/bookings/`)\n}\n\n\n\n\nconst intialState = {allBookings:{}, singleBooking: {}}\n\nconst bookingReducer = (state = intialState, action) => {\n    let newState;\n    switch (action.type) {\n        case LOAD: {\n            newState = {...state, allBookings: {...state.allBookings}, singleBooking: {...state.singleBooking}}\n            let bookingPlaceholder = {}\n            action.bookings.forEach(booking => {\n                bookingPlaceholder[booking.id] = booking\n            })\n            newState.allBookings = bookingPlaceholder\n            return newState\n        }\n        case CREATE:{\n            newState = {...state, allBookings: {...state.allBookings}}\n            newState.allBookings[action.booking.id] = action.booking\n            return newState\n        }\n        default:\n            return state\n    }\n}\n\nexport default bookingReducer\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}